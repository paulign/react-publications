(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(17),i=a.n(r),o=a(26),l=a(23),s=a(27),u=a(40),m=a.n(u),p=a(64),d=a(28),b=a.n(d),f=a(41),v=a(30),g={isCreating:!1,uploadProgress:0,image:null,text:""},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_PUBLICATION_FORM":var a=t.payload,n=a.field,c=a.value;return Object(v.a)({},e,Object(f.a)({},n,c));case"CREATE_PUBLICATION_START":return Object(v.a)({},e,{isCreating:!0,uploadProgress:0});case"CREATE_PUBLICATION_STOP":return Object(v.a)({},e,g);case"UPLOAD_IMAGE_PROGRESS":return Object(v.a)({},e,{uploadProgress:t.payload});default:return e}},E=(a(97),a(7)),O=a(8),j=a(10),y=a(9),C=a(11),x=a(22),k=a(32),w=a(34);k.b.add(w.a,w.c,w.b,w.d);k.b;var P=a(2),N=a(29),L=a(69),R=function(e){function t(){return Object(E.a)(this,t),Object(j.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.image,a=e.onDropImage,n=e.onRemoveImage;return c.a.createElement(L.a,{onDrop:a,accept:"image/*"},function(e){var a=e.getRootProps,r=e.getInputProps,i=e.isDragActive,o=e.isDragAccept,l=e.isDragReject;return c.a.createElement("div",Object.assign({},a(),{className:"dropzone d-flex flex-column align-items-center justify-content-center".concat(o?" accepted":"").concat(l?" rejected":"").concat(i?" active":"")}),c.a.createElement("input",r()),t?c.a.createElement("div",{className:"preview-wrapper"},c.a.createElement(P.a,{onClick:n,close:!0}),c.a.createElement("img",{src:t.preview,alt:""})):[c.a.createElement(N.a,{key:"icon",className:"text-info",size:"2x",icon:"cloud-upload-alt"}),c.a.createElement("span",{key:"text"},i?"Drop":"Drag"," image here...")])})}}]),t}(n.Component),I=a(20),T=a.n(I),S=a(25),A=a(53);a(105),a(110);A.initializeApp({apiKey:"AIzaSyCtXhFVLGvEXaCqb0kOMuBinPxNDL98rWg",authDomain:"react-publicztions.firebaseapp.com",databaseURL:"https://react-publicztions.firebaseio.com",projectId:"react-publicztions",storageBucket:"react-publicztions.appspot.com",messagingSenderId:"228206405360"});var D=A,U=function(){return{type:"CREATE_PUBLICATION_START"}},F=function(){return{type:"CREATE_PUBLICATION_STOP"}},M=function(e){var t=e.image,a=e.id,n=e.onSuccess,c=e.onError,r=e.dispatch;try{var i=D.storage().ref("images"),o={contentType:t.type},l=i.child("".concat(a,"_").concat(t.name)).put(t,o);l.on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;r(function(e){return{type:"UPLOAD_IMAGE_PROGRESS",payload:e}}(t))},function(e){c(e,r)},Object(S.a)(T.a.mark(function e(){var t;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.snapshot.ref.getDownloadURL();case 3:t=e.sent,n(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),c(e.t0,r);case 10:case"end":return e.stop()}},e,this,[[0,7]])})))}catch(s){c(s,r)}},B=function(e,t){console.log(e),t&&(t(F()),t(Object(d.error)({title:"error",message:e.message})))},z=function(e){function t(){var e,a;Object(E.a)(this,t);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(a=Object(j.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(c)))).onChangeText=function(e){a.props.onChangePublicationForm({field:"text",value:e.target.value})},a.onDropImage=function(e){var t={file:e[0],preview:URL.createObjectURL(e[0])};a.props.onChangePublicationForm({field:"image",value:t})},a.onRemoveImage=function(e){e.stopPropagation(),a.props.onChangePublicationForm({field:"image",value:null})},a.onCreate=function(){a.props.createPublication()},a}return Object(C.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isCreating,a=e.uploadProgress,n=e.image,r=e.text;return c.a.createElement(P.d,null,c.a.createElement(P.n,{className:"justify-content-center"},c.a.createElement(P.b,{md:10,lg:8},c.a.createElement(P.e,null,c.a.createElement(P.g,null,"Publication text"),c.a.createElement(P.f,{value:r,onChange:this.onChangeText,placeholder:"Type publication text",type:"textarea",rows:5})),c.a.createElement(P.e,null,c.a.createElement(P.g,null,"Publication image"),c.a.createElement(R,{image:n,onDropImage:this.onDropImage,onRemoveImage:this.onRemoveImage})),c.a.createElement(P.a,{color:"primary",disabled:!r||!!t,onClick:this.onCreate,size:"lg"},"Publish"),!!t&&!!n&&c.a.createElement("div",null,c.a.createElement("div",{className:"text-center"},"Uploading image: ",parseInt(a),"%"),c.a.createElement(P.m,{animated:!0,color:a<100?"primary":"success",value:a})))))}}]),t}(n.Component),_=Object(o.connect)(function(e){return Object(v.a)({},e.publications)},{createPublication:function(){return function(){var e=Object(S.a)(T.a.mark(function e(t,a){var n,c,r,i,o,l,u,m;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{n=a().publications,c=n.text,r=n.image,c&&(t(U()),i=D.database(),o=i.ref("publications").push(),l=o.key,u=D.database.ServerValue.TIMESTAMP,m=function(){var e=Object(S.a)(T.a.mark(function e(){var a,n=arguments;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,e.next=4,o.set({text:c,id:l,image:a,created_at:u});case 4:t(F()),t(Object(d.success)({title:"Success",message:"Publication was successfully created!"})),t(Object(s.push)("/publications/".concat(l))),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),B(e.t0,t);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}(),r?M({id:l,image:r.file,onSuccess:m,onError:B,dispatch:t}):m())}catch(p){B(p,t)}case 1:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},onChangePublicationForm:function(){return{type:"CHANGE_PUBLICATION_FORM",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}})(z),G=a(68),V=a.n(G),H=function(e){var t=e.text,a=e.created_at,n=e.image,r=e.id;return c.a.createElement(x.a,{to:"/publications/".concat(r),className:"publication-card"},c.a.createElement(P.n,null,c.a.createElement(P.b,{className:"mb-2 mb-md-0 publication-text",md:7},c.a.createElement("strong",{className:"mr-2 d-md-none"},"Text:")," ",t),c.a.createElement(P.b,{className:"mb-2 mb-md-0",md:3},c.a.createElement("strong",{className:"mr-2 d-md-none"},"Created at:")," ",V()(a).format("DD/MM/YYYY HH:mm")),c.a.createElement(P.b,{className:"mb-2 mb-md-0",md:2},c.a.createElement("strong",{className:"mr-2 d-md-none"},"Image:"),n?c.a.createElement(N.a,{className:"text-success",icon:"check-circle"}):c.a.createElement(N.a,{className:"text-danger",icon:"times-circle"}))))},W=function(){return c.a.createElement("div",{className:"publications-header"},c.a.createElement(P.n,{className:"d-none d-md-flex"},c.a.createElement(P.b,{md:7},"Text"),c.a.createElement(P.b,{md:3},"Created at"),c.a.createElement(P.b,{md:2},"Image")))},Y=function(e){var t=e.publications,a=void 0===t?[]:t,n=e.isLoading,r=void 0!==n&&n;return a&&a.length?c.a.createElement("div",null,c.a.createElement(W,null),a.map(function(e){return c.a.createElement(H,Object.assign({key:e.id},e))})):c.a.createElement("h4",{className:"text-center"},r?"Loading...":"No publications yet...")},J=[{path:"/publications",showInNav:!0,exact:!0,title:"Publications",component:function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(j.a)(this,Object(y.a)(t).call(this,e))).unsubscribeFromRef=function(e,t){a[e]&&a[e].off("value",t),a[e]=null},a.loadView=function(){try{a.unsubscribeFromRef("listRef",a.onLoadList);var e=D.database();a.listRef=e.ref("publications"),a.listRef.on("value",a.onLoadList)}catch(t){console.log(t),a.setState({isLoading:!1})}},a.onLoadList=function(){var e=Object(S.a)(T.a.mark(function e(t){var n,c;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.val()||{},c=Object.values(n),e.next=5,a.setState({publications:c,isLoading:!1});case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),a.setState({isLoading:!1});case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.state={publications:[],isLoading:!0},a}return Object(C.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.loadView()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromRef("listRef",this.onLoadList)}},{key:"render",value:function(){return c.a.createElement(P.d,{className:"publications-list"},c.a.createElement("h2",null,"Publications list"),c.a.createElement(Y,this.state))}}]),t}(n.Component)},{path:"/publications/:id",title:"Publication Details",component:function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(j.a)(this,Object(y.a)(t).call(this,e))).getCurrentId=function(){var e=null,t=a.props.match;return t.params&&(e=t.params.id||null),e},a.unsubscribeFromRef=function(e,t){a[e]&&a[e].off("value",t),a[e]=null},a.loadView=function(){try{var e=a.state.currentId;if(e){a.unsubscribeFromRef("publicationRef",a.onLoadPublication);var t=D.database();a.publicationRef=t.ref("publications/".concat(e)),a.publicationRef.on("value",a.onLoadPublication)}else a.setState({isLoading:!1})}catch(n){console.log(n),a.setState({isLoading:!1})}},a.onLoadPublication=function(){var e=Object(S.a)(T.a.mark(function e(t){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.val(),e.next=4,a.setState({publication:n,isLoading:!1});case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),a.setState({isLoading:!1});case 10:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),a.state={publication:null,isLoading:!0,currentId:a.getCurrentId()},a}return Object(C.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.loadView()}},{key:"componentWillUnmount",value:function(){this.unsubscribeFromRef("publicationRef",this.onLoadPublication)}},{key:"render",value:function(){var e=this.state,t=e.publication,a=e.isLoading;return c.a.createElement(P.d,{className:"publication-details"},c.a.createElement("h2",null,"Publication details"),t?c.a.createElement(P.n,null,c.a.createElement(P.b,{md:t.image?8:12},c.a.createElement("p",null,t.text)),!!t.image&&c.a.createElement(P.b,{md:4},c.a.createElement("img",{className:"img-fluid w-100",src:t.image,alt:""}))):c.a.createElement("h4",{className:"text-center"},a?"Loading...":"Publication not found"))}}]),t}(n.Component)},{path:"/create-publication",showInNav:!0,title:"Create New",component:_},{redirect:!0,redirectTo:"/create-publication"}],X=function(e){var t=e.path,a=e.title,n=e.showInNav,r=e.redirect,i=e.onClick;return!n||r?null:c.a.createElement(P.i,null,c.a.createElement(x.b,{onClick:i,className:"nav-link",to:t,activeClassName:"active"},a))},q=function(e){function t(e){var a;return Object(E.a)(this,t),(a=Object(j.a)(this,Object(y.a)(t).call(this,e))).toggleCollapse=function(){a.setState({isOpen:!a.state.isOpen})},a.state={isOpen:!1},a}return Object(C.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state.isOpen;return c.a.createElement("header",null,c.a.createElement(P.j,{light:!0,expand:"sm",fixed:"top"},c.a.createElement(P.k,{href:"/"},c.a.createElement(N.a,{className:"mr-3",size:"lg",icon:"camera-retro"}),"React Publications"),c.a.createElement(P.l,{onClick:this.toggleCollapse}),!!J&&!!J.length&&c.a.createElement(P.c,{isOpen:this.state.isOpen,navbar:!0},c.a.createElement(P.h,{className:"mr-auto",navbar:!0},J.map(function(a,n){return c.a.createElement(X,Object.assign({key:n,onClick:t?e.toggleCollapse:null},a))})))))}}]),t}(n.Component),K=a(18),$=a(16),Q=a(24),Z=function(e){function t(){return Object(E.a)(this,t),Object(j.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(O.a)(t,[{key:"componentDidUpdate",value:function(e){"PUSH"===e.history.action&&(document.documentElement.scrollTop=0,this.container.scrollTop=0)}},{key:"render",value:function(){var e=this;return c.a.createElement("main",{className:"content-wrapper",ref:function(t){return e.container=t}},c.a.createElement(K.a,null,J.map(function(e,t){return e.redirect?c.a.createElement(Q.a,{to:e.redirectTo,key:t}):c.a.createElement($.a,{path:e.path,exact:!!e.exact,component:e.component,key:t})})))}}]),t}(n.Component),ee=Object(x.c)(Z),te=function(e){function t(){return Object(E.a)(this,t),Object(j.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return c.a.createElement("footer",{className:"page-footer"},"\xa9 2018 Smartly coded by",c.a.createElement("a",{className:"ml-1 text-dark",href:"https://www.linkedin.com/in/paul-ignatiev/"},c.a.createElement("strong",null,"Paul Ihnatiev")))}}]),t}(n.Component),ae=function(e){function t(){return Object(E.a)(this,t),Object(j.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props.notifications;return c.a.createElement("div",null,c.a.createElement(b.a,{notifications:e}),c.a.createElement(q,null),c.a.createElement(ee,null),c.a.createElement(te,null))}}]),t}(n.Component),ne=Object(x.c)(Object(o.connect)(function(e){return{notifications:e.notifications}})(ae));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce,re=m()(),ie=[p.a],oe=Object(l.e)((ce=re,Object(l.c)({router:Object(s.connectRouter)(ce),notifications:d.reducer,publications:h})),Object(l.d)(l.a.apply(void 0,[Object(s.routerMiddleware)(re)].concat(ie))));i.a.render(c.a.createElement(o.Provider,{store:oe},c.a.createElement(s.ConnectedRouter,{history:re},c.a.createElement(ne,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},70:function(e,t,a){e.exports=a(109)},97:function(e,t,a){}},[[70,2,1]]]);
//# sourceMappingURL=main.c7056505.chunk.js.map